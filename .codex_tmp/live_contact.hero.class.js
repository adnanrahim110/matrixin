class ContactHero extends Component{constructor(ee){super(ee),this.wrapper=this.el.querySelector(".hero-media-wrapper"),this.titleTop=this.el.querySelector(".hero-title-top"),this.titleBottom=this.el.querySelector(".hero-title-bottom"),this.active=!1,this.changeInterval=null,this.duration=2,this.items=[],this.angleOffset=0,this.shiftStep=2,this.progress={time:0},this.unit=Math.PI*2,this.angles=[.16,.34,.6,.75,.87],this.scrolls=[2,1,2,3,2],this.scales=[[.6,.55,.7,.8,.5],[.5,.75,.6,.7,.8],[.65,.6,1,.6,.6]],this.scaleIndex=0,this.anglesRad=this.angles.map(ie=>ie*this.unit),this.iconIndex=0}async init(){super.init(),this.iconEl=this.el.querySelector(".icon"),this.icon=await this.initComponent(Icon,{el:this.iconEl}),await this.icon.ready,this.initContext(),Site.isMobile?(Site.introTl.moveBlur(this.iconEl,{},0),Site.introTl.moveBlur([this.titleTop,this.titleBottom],{stagger:.06},0),Site.introTl.clip(this.wrapper,{duration:1},0),Site.introTl.moveBlur(this.el.querySelector(".hero-scroll"),{},.1)):(Site.introTl.moveBlur([this.titleTop,this.titleBottom],{stagger:.06,yPercent:60},0),Site.introTl.clip(this.el.querySelectorAll(".hero-media-inner"),{stagger:.07,duration:1.4},.2),Site.introTl.moveBlur(this.el.querySelector(".hero-scroll"),{},.3),this.addListener({el:this.iconEl,event:"mouseenter",handler:()=>{this.changeInterval=setInterval(()=>{this.change()},this.duration)}}),this.addListener({el:this.iconEl,event:"mouseleave",handler:()=>{clearInterval(this.changeInterval)}})),this.resolveReady()}change(){if(this.active)return;this.active=!0;let ee,ie;this.iconIndex===6?(this.icon.lottie.goToAndStop(1,!0),this.iconIndex=1,ee=0,ie=this.iconIndex*this.icon.frame):this.iconIndex===5?(this.iconIndex++,ee=this.icon.lottie.currentFrame,ie=this.iconIndex*this.icon.frame-1):(this.iconIndex++,ee=this.icon.lottie.currentFrame,ie=this.iconIndex*this.icon.frame);const re={frame:ee};this.c(()=>{gsapWithCSS.timeline().fromTo(this.progress,{time:0},{time:1,duration:this.duration,ease:"inOut",onUpdate:()=>this.setPositions(),onComplete:()=>{const se=this.anglesRad.length;this.angleOffset=(this.angleOffset-this.shiftStep+se)%se,this.scaleIndex=(this.scaleIndex+1)%this.scales.length,this.active=!1}},0).to(re,{frame:ie,duration:this.duration,ease:"inOut",onUpdate:()=>{this.icon.lottie.goToAndStop(re.frame,!0)}},0).add(()=>{this.items.forEach(se=>this.crossfade(se))},.8)})}crossfade(ee){if(!ee.media||ee.length<=1)return;const ie=ee.media[ee.index];ee.index=(ee.index+1)%ee.length;const re=ee.media[ee.index];this.c(()=>{gsapWithCSS.set(re,{zIndex:3,autoAlpha:0}),gsapWithCSS.set(ie,{zIndex:2}),gsapWithCSS.to(re,{autoAlpha:1,duration:.8,ease:"power2.out",onComplete:()=>{gsapWithCSS.set(ie,{autoAlpha:0,zIndex:1}),gsapWithCSS.set(re,{zIndex:2})}})})}initDesktop(){Site.isMobile||(this.context=gsapWithCSS.context(()=>{this.angleOffset=0,this.scaleIndex=0,this.items=[];const ee=gsapWithCSS.timeline({scrollTrigger:{trigger:this.el,start:"top top",end:"bottom top",scrub:1}});this.el.querySelectorAll(".hero-media").forEach((ie,re)=>{const se=ie.querySelector(".hero-media-inner"),ne=ie.querySelectorAll(".media-wrapper"),oe=this.angles[re]*this.unit,ae=this.scrolls[re];ne.forEach((le,he)=>{gsapWithCSS.set(le,{autoAlpha:he===0?1:0,zIndex:he===0?2:1})}),ee.to(se,{y:-(ae*80)},0),this.items.push({el:ie,inner:se,media:ne,angle:oe,length:ne.length,index:0})}),this.getBounds(),this.setPositions(!0)}))}initMobile(){Site.isMobile&&(this.context=gsapWithCSS.context(()=>{const ee=this.el.querySelectorAll(".hero-media"),ie={frame:this.icon.lottie.currentFrame},re=gsapWithCSS.timeline({scrollTrigger:{trigger:this.el,start:"top top",end:"bottom top",scrub:!0}}).to(ie,{frame:this.icon.frame*3,duration:1,ease:"none",onUpdate:()=>{this.icon.lottie.goToAndStop(ie.frame,!0)}},0);ee.forEach((se,ne)=>{const oe=se.querySelector(".media-wrapper"),ae=se.querySelector(".media"),le=1/(ee.length-2);ne>0&&(re.fromTo(oe,{clipPath:"inset(0 0 100% 0)"},{clipPath:"inset(0 0 0% 0)",ease:"none",duration:le},(ne-1)*le),re.fromTo(ae,{scale:1.4},{scale:1,ease:"none",duration:le},(ne-1)*le)),re.fromTo(ae,{autoAlpha:1},{autoAlpha:.6,ease:"none",duration:le},ne*le)})}))}initContext(){this.context?.revert(),this.initDesktop(),this.initMobile()}getBounds(){this.bounds=this.wrapper.getBoundingClientRect(),this.radiusX=this.bounds.width*.5,this.radiusY=this.bounds.height*.5,this.items.forEach(ee=>{ee.bounds=ee.el.getBoundingClientRect()})}lerpAngle(ee,ie,re){let se=(ie-ee)%this.unit;return se>Math.PI&&(se-=this.unit),se<-Math.PI&&(se+=this.unit),ee+se*re}setPositions(ee=!1){const ie=this.anglesRad.length,re=this.progress.time,se=this.scaleIndex,ne=(this.scaleIndex+1)%this.scales.length;this.items.forEach((oe,ae)=>{const le=this.anglesRad[(ae+this.angleOffset)%ie],he=this.anglesRad[(ae+this.angleOffset-this.shiftStep+ie)%ie],ce=ee?le:this.lerpAngle(le,he,re),me=this.scales[se][(ae+this.angleOffset)%ie],ue=this.scales[ne][(ae+this.angleOffset-this.shiftStep+ie)%ie],pe=ee?me:lerp(me,ue,re),de=Math.cos(ce),fe=Math.sin(ce),be=this.radiusX+de*this.radiusX-oe.bounds.width*.5,ye=this.radiusY-fe*this.radiusY-oe.bounds.height*.5;gsapWithCSS.set(oe.el,{x:be,y:ye,scale:pe})})}loop(){super.loop(),this.active&&this.setPositions()}resize(){super.resize(),this.initContext()}destroy(){super.destroy()}}class Contact extends Page{constructor(ee){super(ee),this.theme="dark"}async init(){super.init(),await this.initComponent(ContactHero,{el:this.el.querySelector(".hero")}).ready,this.resolveReady()}loaded(){super.loaded(),this.initForm(),this.initComponent(Footer,{el:this.el.querySelector(".footer")})}initForm(){const ee=this.el.querySelector(".form");this.initComponent(ButtonBlock,{el:ee.querySelector(".btn-block")});const ie=ee.querySelector('[name="ts"]');if(ie.value=Date.now(),!Site.isMobile){const re=()=>Site.lenis?.stop?.(),se=()=>Site.lenis?.start?.();ee.addEventListener("pointerdown",re,{passive:!0}),ee.addEventListener("pointerup",se,{passive:!0}),ee.addEventListener("pointercancel",se,{passive:!0}),ee.addEventListener("submit",se)}this.addListener({el:ee,event:"submit",handler:async re=>{re.preventDefault(),ee.classList.add("loading");const se=await fetch(ee.action,{method:"POST",body:new FormData(ee)});ee.classList.remove("loading"),Site.isDebug&&console.log(se),se.ok?(ee.reset(),Site.toast.show("Thanks for getting in touch! We'll get back to you shortly.")):Site.toast.show("Oops, something went wrong. Please refresh the page and try again.",!0)}})}resize(){super.resize()}mousemove(){super.mousemove()}loop(ee){super.loop(ee)}destroy(){super.destroy()}}
