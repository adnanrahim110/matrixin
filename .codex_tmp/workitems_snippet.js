WorkItems extends Component{constructor(ee){super(ee),this.filter=this.el.querySelector("#work-filter"),this.grid=this.el.querySelector(".work-grid"),this.list=this.el.querySelector(".work-list"),this.listWrapper=this.list.querySelector(".work-list-wrapper"),this.listInner=this.list.querySelector(".work-list-inner"),this.listProjects=this.list.querySelector(".work-list-projects"),this.gridCtaWrapper=this.grid.querySelector(".work-cta-wrapper"),this.gridCta=this.grid.querySelector(".work-cta-inner"),this.listCtaWrapper=this.list.querySelector(".work-cta-wrapper"),this.listCta=this.list.querySelector(".work-cta-inner"),this.activeFilter="all",this.activeView=0,this.projects=[],this.borders=Site.isMobile?null:[]}init(){super.init(),this.el.querySelectorAll(".project").forEach(ee=>{const ie=JSON.parse(ee.getAttribute("data-services"));if(ee.classList.contains("work-list-project")&&this.c(()=>{split(ee.querySelector(".project-number")),splitLines(ee.querySelector(".project-client")),splitLines(ee.querySelector(".project-title"))}),!Site.isMobile){const re=ee.querySelector(".project-border");re&&this.borders.push(this.initComponent(Border,{el:re,inner:!0}))}this.projects.push({el:ee,services:ie})}),this.c(()=>{gsapWithCSS.timeline({scrollTrigger:{trigger:this.el.querySelector(".work-title-wrapper"),start:"top top",end:()=>`+=${Site.height*1}`,pin:!0,pinType:Site.isMobile?"fixed":"transform",scrub:!0}}).to(this.el,{duration:1},0).to(this.el.querySelector(".work-title"),{autoAlpha:0,filter:"blur(1.2rem)",duration:.3},0)}),this.addListener({el:this.el.querySelector("#work-filter"),event:"change",handler:()=>{this.activeFilter=this.filter.value,this.out(),setTimeout(()=>{Site.lenis.scrollTo(0,{immediate:!0}),this.projects.forEach(ee=>{ee.el.classList.remove("inactive"),this.filter.value!=="all"&&(ee.services.includes(this.activeFilter)||ee.el.classList.add("inactive"))}),this.in()},250)}}),this.el.querySelectorAll('[name="work-switcher"]').forEach((ee,ie)=>{this.addListener({el:ee,event:"change",handler:()=>{ee.checked&&(this.out(),this.activeView=ie,setTimeout(()=>{Site.lenis.scrollTo(0,{immediate:!0}),this.in()},250))}})}),this.gridIn()}out(){this.grid.classList.remove("loaded"),this.list.classList.remove("loaded"),this.borders?.forEach(ee=>ee.active=!1)}in(){this.grid.classList.remove("active"),this.list.classList.remove("active"),this.workContext?.revert(),this.activeView>0?this.listIn():this.gridIn(),Site.refresh()}gridIn(){this.workContext=gsapWithCSS.context(()=>{this.grid.classList.add("active");const ee=this.grid.querySelectorAll(".project:not(.active)");Site.isMobile||gsapWithCSS.timeline({scrollTrigger:{trigger:this.gridCtaWrapper,start:"top bottom",end:"bottom bottom",scrub:!0}}).fromTo(this.gridCta,{height:0},{height:Site.width*.44});const ie=gsapWithCSS.timeline({pause:!0}).fromTo(ee,{autoAlpha:0,y:"5rem"},{autoAlpha:1,y:0,duration:2,ease:"power3.out",stagger:.1});this.grid.classList.add("loaded"),ie.play()})}listIn(){this.workContext=gsapWithCSS.context(()=>{this.list.classList.add("active"),this.borders?.forEach(ie=>ie.active=!0),this.items=[],this.stagger=.1;const ee=gsapWithCSS.timeline({paused:!0});Site.isMobile||(this.height=remToPx(7.4),this.activeHeight=remToPx(26),this.imageHeight=remToPx(3.4),this.activeImageHeight=remToPx(22)),this.list.querySelectorAll(".project:not(.inactive)").forEach((ie,re)=>{const se=ie.querySelector(".project-media"),ne=ie.querySelector(".project-border"),oe=ie.querySelector(".project-number .line"),ae=ie.querySelectorAll(".project-client .line-inner"),le=ie.querySelectorAll(".project-title .line-inner");oe.textContent=String(re+1).padStart(2,"0"),re===0&&!Site.isMobile&&(gsapWithCSS.set(ie,{height:this.activeHeight}),gsapWithCSS.set(se,{height:this.activeImageHeight,autoAlpha:1})),this.items.push({el:ie,image:se,border:ne,number:oe,client:ae,title:le})}),Site.isMobile||(this.ctaHeight=this.listCtaWrapper.offsetHeight,this.totalHeight=Math.ceil(this.height*(this.items.length-1)+this.activeHeight),this.offCenter=Site.height*.6-(Site.height-this.activeHeight)*.5,this.finalOffset=(Site.height-this.activeHeight)*.5+this.activeHeight-(Site.height-this.ctaHeight),this.baseDuration=1.5,this.duration=this.baseDuration/(this.items.length-1),this.finalStart=.1+this.baseDuration,this.distanceOne=Site.height*.5,this.distanceTwo=this.totalHeight,this.distanceThree=Site.height*4,gsapWithCSS.set(this.list,{height:this.distanceOne+this.distanceTwo+this.distanceThree}),gsapWithCSS.set(this.listWrapper,{height:this.distanceOne+this.distanceTwo+this.distanceThree}),this.sTl=gsapWithCSS.timeline({scrollTrigger:{trigger:this.listWrapper,start:"top top",end:"bottom bottom",pin:!0,scrub:!0,pinSpacing:!1,onUpdate:()=>{this.borders.forEach(ie=>ie.getBounds(!1))}},defaults:{ease:"none",duration:this.duration}}).to(this.listInner,{y:-this.offCenter,ease:"power1.out",duration:.2},0).to(this.listProjects,{y:-(this.totalHeight-Site.height+(Site.height-this.activeHeight)),duration:this.baseDuration},.1).to(this.listInner,{y:-this.finalOffset,duration:.4},this.finalStart).to(this.listCtaWrapper,{y:-this.finalOffset,duration:.4},this.finalStart).fromTo(this.listCta,{height:0},{height:Site.width*.44,duration:.4},this.finalStart)),this.items.forEach((ie,re)=>{const se=re*.2;if(!Site.isMobile){const oe=.1+re*this.duration,ae=oe-this.duration,le=ie.el,he=ie.image;re===0?(this.sTl.to(le,{height:this.height},.1),this.sTl.to(he,{height:this.imageHeight},.1),this.sTl.to(he,{autoAlpha:0},.1)):(re!==this.items.length-1?(this.sTl.to(le,{height:this.height},oe),this.sTl.to(he,{height:this.imageHeight},oe),this.sTl.to(he,{autoAlpha:0},oe)):(this.sTl.to(le,{height:this.height,duration:.4},this.finalStart),this.sTl.to(he,{height:this.imageHeight,duration:.4},this.finalStart),this.sTl.to(he,{autoAlpha:0,duration:.4},this.finalStart)),this.sTl.to(le,{height:this.activeHeight},ae),this.sTl.to(he,{height:this.activeImageHeight},ae),this.sTl.to(he,{autoAlpha:1},ae))}ee.fromTo(ie.border,{clipPath:"inset(0 100% 0 0)"},{clipPath:"inset(0 0% 0 0)",duration:1.4,ease:"power3.inOut"},se),ee.fromTo(ie.image,{clipPath:"inset(0 0 100% 0)"},{clipPath:"inset(0 0 0% 0)",duration:1.4,ease:"power3.inOut"},se+.1),ee.fromTo(ie.number,{yPercent:105},{yPercent:0,duration:1.6,ease:"power3.out"},se),ee.fromTo(ie.client,{yPercent:105},{yPercent:0,duration:1.6,ease:"power3.out",stagger:.06},se+.1),ee.fromTo(ie.title,{yPercent:105},{yPercent:0,duration:1.6,ease:"power3.out",stagger:.06},se+.2)}),this.list.classList.add("loaded"),Site.lenis.resize(),ee.play()})}resize(){super.resize(),this.out(),this.in()}destroy(){super.destroy(),this.workContext?.revert()}}
